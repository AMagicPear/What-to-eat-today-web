const __vite__fileDeps=["assets/EditFood-BZBAnWxq.js","assets/index-g5BOJItH.js","assets/index-7CQuqmcz.css","assets/foodConstructor-DJjRY9nd.js","assets/EditFood-Dddx6p5_.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{r as p,c as b,t as y,_ as w,d as N,o as P,a as x,w as u,u as a,b as B,e as r,I as C,f as D,g as c,h as T,i as k,j as _,k as O,l as h,m as L,n as V,p as S,q as E}from"./index-g5BOJItH.js";import{s as F,F as H}from"./foodConstructor-DJjRY9nd.js";const d=p([]),I=()=>{const l=async n=>{const e={time:f.value,name:n};d.value.push(e),await F.set("log",JSON.parse(JSON.stringify(d.value))),console.log("成功保存记录")};return(async()=>{const n=await F.get("log");d.value=n?n.map(e=>({...e,time:new Date(e.time)})):[],console.log("已读取记录"),console.log(d.value)})(),{saveLog:l}},W=Object.freeze(Object.defineProperty({__proto__:null,Log:I,logs:d},Symbol.toStringTag,{value:"Module"})),f=p(new Date),{foodList:m,loadFoods:j,saveFoods:A}=H(),{saveLog:M}=I(),J=async()=>{await j();const{isCheckBoxDisabled:l,checkedList:s}=await w(()=>import("./EditFood-BZBAnWxq.js"),__vite__mapDeps([0,1,2,3,4]));let n=l.value?m.value:m.value.filter((o,t)=>s.value[t]);console.log("第一次筛选后的食物："),console.log(n);const{logs:e}=await w(()=>Promise.resolve().then(()=>W),void 0);if(console.log("最后两项：",e.value[e.value.length-1].name,e.value[e.value.length-2].name),e.value.length>=2&&n.length>2&&e.value[e.value.length-1].name===e.value[e.value.length-2].name&&(n=n.filter(o=>o.name!==e.value[e.value.length-1].name)),console.log("第二次筛选后的食物："),console.log(n),l.value&&e.value.length>=30){const t=e.value.slice(-30).map(i=>i.name),g=n.filter(i=>!t.includes(i.name));g.length>0&&(n=g),console.log("第三次筛选后的食物："),console.log(n)}return n.map(o=>{let t=0;return v.value==="早"?t=o.weight.morning:v.value==="早中"?t=(o.weight.morning+o.weight.noon)/2:v.value==="午"?t=o.weight.noon:t=o.weight.evening,{name:o.name,weight:t}})},v=b(()=>{const l=f.value.getHours();return l>=6&&l<9?"早":l>=9&&l<11?"早中":l>=11&&l<14?"午":"晚"}),R=async()=>{const l=await J();console.log("正在选择食物，当前可选食物列表："),console.log(l);const s=l.reduce((o,t)=>o+Number(t.weight),0);if(console.log("当前总重：".concat(s)),s===0)return await(await y.create({message:"当前时段所有可选食物的概率都为零，无法选择！",duration:2e3})).present(),null;const e=((o,t)=>{let g=Math.random()*t;for(const i of o)if(g-=Number(i.weight),g<=0)return i;return null})(l,s);if(e){const o=m.value.find(t=>t.name===e.name);o&&(console.log("选择了："),o.counts+=1,await A(),console.log(o),console.log("目前的食物列表："),console.log(m.value),await M(o.name))}return e};function $(){f.value=new Date}const q=N({__name:"HomePage",setup(l){P(()=>{setInterval($,6e4)});const s=p();return(n,e)=>(B(),x(a(S),null,{default:u(()=>[r(a(T),null,{default:u(()=>[r(a(C),null,{default:u(()=>[r(a(D),null,{default:u(()=>e[1]||(e[1]=[c("今天吃什么")])),_:1})]),_:1})]),_:1}),r(a(V),{class:"ion-padding"},{default:u(()=>[r(a(k),null,{default:u(()=>[c(_(a(f)),1)]),_:1}),r(a(O),{onClick:e[0]||(e[0]=o=>a(R)().then(t=>s.value=t))},{default:u(()=>e[2]||(e[2]=[c("选择食物")])),_:1}),e[4]||(e[4]=h("br",null,null,-1)),r(a(L),null,{default:u(()=>[c("今天的"+_(a(v))+"饭要吃的食物是：",1),e[3]||(e[3]=h("br",null,null,-1))]),_:1}),r(a(L),{style:{"text-align":"center"}},{default:u(()=>{var o;return[c(_((o=s.value)==null?void 0:o.name),1)]}),_:1})]),_:1})]),_:1}))}}),K=E(q,[["__scopeId","data-v-f4882aa0"]]);export{K as default};
