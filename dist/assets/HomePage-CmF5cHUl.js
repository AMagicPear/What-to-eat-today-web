const __vite__fileDeps=["assets/EditFood-BOexOaet.js","assets/index-B-9Gt_St.js","assets/index-7CQuqmcz.css","assets/foodConstructor-Csf4jzYi.js","assets/EditFood-Dddx6p5_.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{r as p,c as F,t as I,_ as N,d as y,o as b,a as x,w as r,u as a,b as B,e as i,I as C,f as k,g as c,h as D,i as P,j as f,k as T,l as h,m as _,n as V,p as H,q as W}from"./index-B-9Gt_St.js";import{s as L,F as O}from"./foodConstructor-Csf4jzYi.js";const t=p([]),S=()=>{const n=async l=>{const e={time:v.value,name:l};t.value.push(e),await L.set("log",JSON.parse(JSON.stringify(t.value))),console.log("成功保存记录")};return(async()=>{const l=await L.get("log");t.value=l?l.map(e=>({...e,time:new Date(e.time)})):[],console.log("已读取记录"),console.log(t.value)})(),{saveLog:n}},v=p(new Date),{foodList:m,loadFoods:A,saveFoods:E}=O(),{saveLog:J}=S(),M=async()=>{await A();const{isCheckBoxDisabled:n,checkedList:u}=await N(()=>import("./EditFood-BOexOaet.js"),__vite__mapDeps([0,1,2,3,4]));let l=n.value?m.value:m.value.filter((e,o)=>u.value[o]);if(console.log("第一次筛选后的食物："),console.log(l),t.value.length>=2&&(console.log("最后两项：",t.value[t.value.length-1].name,t.value[t.value.length-2].name),l.length>2&&t.value[t.value.length-1].name===t.value[t.value.length-2].name&&(l=l.filter(e=>e.name!==t.value[t.value.length-1].name),console.log("第二次筛选后的食物："),console.log(l))),n.value&&t.value.length>=30){const o=t.value.slice(-30).map(g=>g.name),s=l.filter(g=>!o.includes(g.name));s.length>0&&(l=s),console.log("第三次筛选后的食物："),console.log(l)}return l.map(e=>{let o=0;return d.value==="早"?o=e.weight.morning:d.value==="早中"?o=(e.weight.morning+e.weight.noon)/2:d.value==="午"?o=e.weight.noon:o=e.weight.evening,{name:e.name,weight:o}})},d=F(()=>{const n=v.value.getHours();return n>=6&&n<9?"早":n>=9&&n<11?"早中":n>=11&&n<14?"午":"晚"}),$=async()=>{const n=await M();console.log("正在选择食物，当前可选食物列表："),console.log(n);const u=n.reduce((o,s)=>o+Number(s.weight),0);if(console.log("当前总重：".concat(u)),u===0)return await(await I.create({message:"当前时段所有可选食物的概率都为零，无法选择！",duration:2e3})).present(),null;const e=((o,s)=>{let g=Math.random()*s;for(const w of o)if(g-=Number(w.weight),g<=0)return w;return null})(n,u);if(e){const o=m.value.find(s=>s.name===e.name);o&&(console.log("选择了："),o.counts+=1,await E(),console.log(o),console.log("目前的食物列表："),console.log(m.value),await J(o.name))}return e};function j(){v.value=new Date}const q=y({__name:"HomePage",setup(n){b(()=>{setInterval(j,6e4)});const u=p();return(l,e)=>(B(),x(a(H),null,{default:r(()=>[i(a(D),null,{default:r(()=>[i(a(C),null,{default:r(()=>[i(a(k),null,{default:r(()=>e[1]||(e[1]=[c("今天吃什么")])),_:1})]),_:1})]),_:1}),i(a(V),{class:"ion-padding"},{default:r(()=>[i(a(P),null,{default:r(()=>[c(f(a(v)),1)]),_:1}),i(a(T),{onClick:e[0]||(e[0]=o=>a($)().then(s=>u.value=s))},{default:r(()=>e[2]||(e[2]=[c("选择食物")])),_:1}),e[4]||(e[4]=h("br",null,null,-1)),i(a(_),null,{default:r(()=>[c("今天的"+f(a(d))+"饭要吃的食物是：",1),e[3]||(e[3]=h("br",null,null,-1))]),_:1}),i(a(_),{style:{"text-align":"center"}},{default:r(()=>{var o;return[c(f((o=u.value)==null?void 0:o.name),1)]}),_:1})]),_:1})]),_:1}))}}),G=W(q,[["__scopeId","data-v-f4882aa0"]]);export{G as default};
