const __vite__fileDeps=["assets/EditFood-CUpn0syq.js","assets/index-sleVqp5b.js","assets/index-7CQuqmcz.css","assets/foodConstructor-BhdAbuRI.js","assets/EditFood-DdfLmwIF.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{r as f,c as b,t as y,_ as p,d as N,o as P,a as x,w as u,u as a,b as B,e as r,I as C,f as D,g as i,h as T,i as k,j as m,k as O,l as h,m as I,n as V,p as S,q as E}from"./index-sleVqp5b.js";import{s as F,F as H}from"./foodConstructor-BhdAbuRI.js";const g=f([]),L=()=>{const t=async n=>{const e={time:v.value,name:n};g.value.push(e),await F.set("log",JSON.parse(JSON.stringify(g.value))),console.log("成功保存记录")};return(async()=>{const n=await F.get("log");g.value=n?n.map(e=>({...e,time:new Date(e.time)})):[],console.log("已读取记录"),console.log(g.value)})(),{saveLog:t}},W=Object.freeze(Object.defineProperty({__proto__:null,Log:L,logs:g},Symbol.toStringTag,{value:"Module"})),v=f(new Date),{foodList:d,loadFoods:j,saveFoods:M}=H(),{saveLog:A}=L(),J=async()=>{await j();const{isCheckBoxDisabled:t,checkedList:s}=await p(()=>import("./EditFood-CUpn0syq.js"),__vite__mapDeps([0,1,2,3,4]));let n=t.value?d.value:d.value.filter((o,l)=>s.value[l]);console.log("第一次筛选后的食物："),console.log(n);const{logs:e}=await p(()=>Promise.resolve().then(()=>W),void 0);return console.log("最后两项：",e.value[e.value.length-1].name,e.value[e.value.length-2].name),e.value.length>=2&&n.length>2&&e.value[e.value.length-1].name===e.value[e.value.length-2].name&&(n=n.filter(o=>o.name!==e.value[e.value.length-1].name)),console.log("第二次筛选后的食物："),console.log(n),n.map(o=>{let l=0;return c.value==="早"?l=o.weight.morning:c.value==="早中"?l=(o.weight.morning+o.weight.noon)/2:c.value==="午"?l=o.weight.noon:l=o.weight.evening,{name:o.name,weight:l}})},c=b(()=>{const t=v.value.getHours();return t>=6&&t<9?"早":t>=9&&t<11?"早中":t>=11&&t<14?"午":"晚"}),R=async()=>{const t=await J();console.log("正在选择食物，当前可选食物列表："),console.log(t);const s=t.reduce((o,l)=>o+Number(l.weight),0);if(console.log("当前总重：".concat(s)),s===0)return await(await y.create({message:"当前时段所有可选食物的概率都为零，无法选择！",duration:2e3})).present(),null;const e=((o,l)=>{let _=Math.random()*l;for(const w of o)if(_-=Number(w.weight),_<=0)return w;return null})(t,s);if(e){const o=d.value.find(l=>l.name===e.name);o&&(console.log("选择了："),o.counts+=1,await M(),console.log(o),console.log("目前的食物列表："),console.log(d.value),await A(o.name))}return e};function $(){v.value=new Date}const q=N({__name:"HomePage",setup(t){P(()=>{setInterval($,6e4)});const s=f();return(n,e)=>(B(),x(a(S),null,{default:u(()=>[r(a(T),null,{default:u(()=>[r(a(C),null,{default:u(()=>[r(a(D),null,{default:u(()=>e[1]||(e[1]=[i("今天吃什么")])),_:1})]),_:1})]),_:1}),r(a(V),{class:"ion-padding"},{default:u(()=>[r(a(k),null,{default:u(()=>[i(m(a(v)),1)]),_:1}),r(a(O),{onClick:e[0]||(e[0]=o=>a(R)().then(l=>s.value=l))},{default:u(()=>e[2]||(e[2]=[i("选择食物")])),_:1}),e[4]||(e[4]=h("br",null,null,-1)),r(a(I),null,{default:u(()=>[i("今天的"+m(a(c))+"饭要吃的食物是：",1),e[3]||(e[3]=h("br",null,null,-1))]),_:1}),r(a(I),{style:{"text-align":"center"}},{default:u(()=>{var o;return[i(m((o=s.value)==null?void 0:o.name),1)]}),_:1})]),_:1})]),_:1}))}}),K=E(q,[["__scopeId","data-v-2e6c47cf"]]);export{K as default};
