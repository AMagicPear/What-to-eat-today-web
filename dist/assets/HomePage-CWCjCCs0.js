import{r as c,d as I,o as L,c as _,w as s,u as t,a as y,b as a,I as N,e as b,f as u,g as x,h as B,t as v,i as C,j as k,k as p,l as D,m as T,_ as V}from"./index-D2QuaPaO.js";import{s as F,F as W}from"./foodConstructor-CnAj7M3z.js";const w=()=>{const n=c([]);return{saveLog:async o=>{const e={time:i.value,name:o};n.value.push(e),await F.set("log",JSON.parse(JSON.stringify(n.value))),console.log("成功保存记录")},loadLog:async()=>{const o=await F.get("log");n.value=o?o.map(e=>({...e,time:new Date(e.time)})):[],console.log("已读取记录"),console.log(n.value)}}},i=c(new Date),{foodList:r,loadFoods:H,saveFoods:P}=W(),{saveLog:S}=w(),h=async()=>(await H(),r.value),J=async()=>{const n=await h();console.log("正在选择食物，当前可选食物列表："),console.log(n);const d=n.reduce((e,l)=>e+Number(l.weight),0);if(d===0)return alert("当前时段所有可选食物的概率都为零。无法选择！"),null;const o=((e,l)=>{let f=Math.random()*l;for(const m of e)if(f-=Number(m.weight),f<=0)return m;return null})(n,d);if(o){const e=r.value.find(l=>l.name===o.name);e&&(console.log("选择了："),e.counts+=1,P(),console.log(e),console.log("目前的食物列表："),console.log(r.value),S(e.name))}return o};function M(){i.value=new Date}const{loadLog:O}=w(),j=I({__name:"HomePage",setup(n){L(()=>{setInterval(M,1e3),O()});const d=c();return(g,o)=>(y(),_(t(T),null,{default:s(()=>[a(t(x),null,{default:s(()=>[a(t(N),null,{default:s(()=>[a(t(b),null,{default:s(()=>o[1]||(o[1]=[u("今天吃什么")])),_:1})]),_:1})]),_:1}),a(t(D),{class:"ion-padding"},{default:s(()=>[a(t(B),null,{default:s(()=>[u(v(t(i)),1)]),_:1}),a(t(C),{onClick:o[0]||(o[0]=e=>t(J)().then(l=>d.value=l))},{default:s(()=>o[2]||(o[2]=[u("选择食物")])),_:1}),o[4]||(o[4]=k("br",null,null,-1)),a(t(p),null,{default:s(()=>o[3]||(o[3]=[u("今天要吃的食物是： ")])),_:1}),a(t(p),{style:{"text-align":"center"}},{default:s(()=>{var e;return[u(v((e=d.value)==null?void 0:e.name),1)]}),_:1})]),_:1})]),_:1}))}}),z=V(j,[["__scopeId","data-v-30fc3824"]]);export{z as default};
